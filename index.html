<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IronWood Forum - Local Version</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
:root {
  --bg-dark:#110B1D; --card-dark:#1C1230; --input-dark:#160F25;
  --accent:#BB60FF; --accent-hover:#D89BFF; --staff-color:#FF6347;
  --staff-color-dark:#8F3728; --text-light:#f3f4f6;
}
body{font-family:'Inter',sans-serif;background-color:var(--bg-dark);color:var(--text-light);min-height:100vh;}
.admin-badge{background-color:var(--accent);color:white;padding:2px 8px;border-radius:9999px;font-size:.75rem;font-weight:700;}
.category-staff{border-left-color:var(--staff-color);}
.category-forum{border-left-color:var(--accent);}
.thread-card-clickable{cursor:pointer;transition:transform .2s ease-out,box-shadow .2s ease-out;}
.thread-card-clickable:hover{transform:translateY(-3px);}
.back-button{transition:color .2s;}
.back-button:hover{color:var(--accent-hover);}
.form-disabled{opacity:.6;cursor:not-allowed;pointer-events:none;}
</style>
</head>
<body class="selection:bg-[var(--accent)] selection:text-white">

<div class="max-w-4xl mx-auto p-4 sm:p-6 lg:p-8">

<header class="mb-8 p-4 bg-[var(--card-dark)] rounded-xl flex flex-col sm:flex-row justify-between items-center border border-zinc-700 shadow-xl">
<h1 class="text-3xl font-extrabold text-[var(--accent)] mb-4 sm:mb-0">IRONWOOD FORUMS</h1>
<div class="flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-4">
<div class="flex space-x-2">
<button onclick="showView('list')" class="px-4 py-2 text-sm font-semibold rounded-lg bg-[var(--card-dark)] hover:bg-[var(--bg-dark)] text-white transition duration-150 border border-zinc-700">All Threads</button>
<button onclick="showView('staff')" class="px-4 py-2 text-sm font-semibold rounded-lg bg-[var(--staff-color-dark)] hover:brightness-125 text-white transition duration-150">Staff Info</button>
</div>
<div id="user-info" class="text-right p-2 rounded-lg bg-[var(--bg-dark)] border border-zinc-700 w-full sm:w-auto">
<p class="text-xs font-medium text-gray-400">Admin Password:</p>
<div class="flex items-center justify-end">
<input id="admin-pass" type="password" placeholder="Enter password" class="p-1 rounded text-black text-sm"/>
<button onclick="checkAdmin()" class="ml-2 px-2 py-1 bg-[var(--accent)] hover:bg-[var(--accent-hover)] rounded text-white text-sm">Login</button>
<span id="user-admin-badge"></span>
</div>
</div>
</div>
</header>

<!-- LIST VIEW -->
<div id="list-view" class="main-view">
<div id="new-thread-form-container" class="bg-[var(--card-dark)] p-6 rounded-xl mb-8 border border-zinc-700 shadow-lg">
<h2 class="text-2xl font-semibold mb-4 text-white border-b border-zinc-700 pb-3">Start a New Discussion</h2>
<select id="new-category" class="w-full p-3 mb-4 rounded-lg bg-[var(--input-dark)] text-white focus:ring-2 focus:ring-[var(--accent)] border border-zinc-700 cursor-pointer">
<option value="Forums">Forums (Public)</option>
<option value="Staff Information" disabled>Staff Information (Admin Only)</option>
</select>
<input type="text" id="new-title" placeholder="Thread Title" class="w-full p-3 mb-4 rounded-lg bg-[var(--input-dark)] text-white placeholder-gray-500 focus:ring-2 focus:ring-[var(--accent)] border border-zinc-700"/>
<textarea id="new-content" rows="4" placeholder="Your thread content..." class="w-full p-3 mb-4 rounded-lg bg-[var(--input-dark)] text-white placeholder-gray-500 focus:ring-2 focus:ring-[var(--accent)] border border-zinc-700 resize-none"></textarea>
<button id="post-thread-button" onclick="postThread()" class="w-full px-6 py-3 bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-white font-bold rounded-lg transition duration-200">Post Thread</button>
</div>

<h2 class="text-2xl font-semibold mb-4 text-white border-b border-zinc-700 pb-2">All Active Threads</h2>
<section id="all-threads-list" class="space-y-4"></section>
</div>

<!-- STAFF VIEW -->
<div id="staff-view" class="main-view hidden">
<button onclick="showView('list')" class="back-button mb-4 text-[var(--accent)] flex items-center">‚Üê Back to All Threads</button>
<h2 class="text-3xl font-extrabold text-[var(--staff-color)] mb-6 border-b border-zinc-700 pb-3">Staff Information & Announcements</h2>
<section id="staff-threads-list" class="space-y-4"></section>
</div>

<script>
let threads = JSON.parse(localStorage.getItem('threads')||'[]');
let isAdmin = false;
const ADMIN_PASSWORD = "AVARIN";

function alertModal(msg,type='info'){
  const modal=document.getElementById('alert-modal'); 
  const header=document.getElementById('modal-header'); 
  const content=document.getElementById('alert-message');
  header.style.backgroundColor = type==='success'?'green':type==='error'?'var(--staff-color)':'var(--accent)'; 
  content.textContent=msg; modal.classList.remove('hidden');
}
function closeAlertModal(){document.getElementById('alert-modal').classList.add('hidden');}

function checkAdmin(){
  const pass=document.getElementById('admin-pass').value;
  if(pass===ADMIN_PASSWORD){
    isAdmin=true;
    document.getElementById('user-admin-badge').innerHTML='<span class="admin-badge ml-2">ADMIN</span>';
    document.getElementById('new-category').querySelector('option[value="Staff Information"]').disabled=false;
    renderThreads();
    alertModal("Admin login successful","success");
  } else alertModal("Wrong password","error");
}

function saveThreads(){localStorage.setItem('threads',JSON.stringify(threads));}

function postThread(){
  const title=document.getElementById('new-title').value.trim();
  const content=document.getElementById('new-content').value.trim();
  const category=document.getElementById('new-category').value;
  if(!title||!content) return alertModal("Please fill title and content","error");
  if(category==="Staff Information"&&!isAdmin) return alertModal("Only admin can post in Staff Information","error");
  const thread={id:Date.now(),title,content,category,author:isAdmin?'ADMIN':'GUEST'};
  threads.push(thread); saveThreads(); renderThreads();
  document.getElementById('new-title').value=''; document.getElementById('new-content').value=''; document.getElementById('new-category').value="Forums";
  alertModal("Thread posted successfully","success");
}

function editThread(id){
  if(!isAdmin) return alertModal("Only admin can edit threads","error");
  const thread=threads.find(t=>t.id===id); if(!thread) return;
  const newTitle=prompt("Edit title:",thread.title); const newContent=prompt("Edit content:",thread.content);
  if(newTitle!==null) thread.title=newTitle; if(newContent!==null) thread.content=newContent;
  saveThreads(); renderThreads();
}

function deleteThread(id){
  if(!isAdmin) return alertModal("Only admin can delete threads","error");
  if(!confirm("Are you sure you want to delete this thread?")) return;
  threads=threads.filter(t=>t.id!==id); saveThreads(); renderThreads();
}

function renderThreads(){
  const allList=document.getElementById('all-threads-list');
  const staffList=document.getElementById('staff-threads-list');
  allList.innerHTML=''; staffList.innerHTML='';
  threads.forEach(t=>{
    const html=`
    <div class="bg-[var(--card-dark)] p-5 rounded-xl mb-4 border-l-4 ${t.category==='Staff Information'?'category-staff':'category-forum'}">
      <div class="flex justify-between items-start mb-2">
        <h2 class="text-xl font-bold text-[var(--accent)]">${t.title}</h2>
        <span class="text-xs font-semibold px-3 py-1 rounded-full ${t.category==='Staff Information'?'bg-[var(--staff-color-dark)] text-[var(--staff-color)]':'bg-purple-900 text-[var(--accent)]'}">${t.category}</span>
      </div>
      <div class="text-sm text-gray-400 mb-3">
        Posted by: <span class="font-medium text-white">${t.author}</span>
      </div>
      <p class="text-gray-300 whitespace-pre-wrap">${t.content}</p>
      ${isAdmin?`
      <div class="mt-2">
        <button onclick="editThread(${t.id})" class="text-sm px-2 py-1 bg-[var(--accent)] rounded text-white mr-2">Edit</button>
        <button onclick="deleteThread(${t.id})" class="text-sm px-2 py-1 bg-[var(--staff-color)] rounded text-white">Delete</button>
      </div>`:''}
    </div>`;
    allList.innerHTML+=html;
    if(t.category==='Staff Information') staffList.innerHTML+=html;
  });
}

function showView(view){
  document.querySelectorAll('.main-view').forEach(v=>v.classList.add('hidden'));
  document.getElementById(view+'-view').classList.remove('hidden');
}

// Initial render
renderThreads();
</script>

<!-- ALERT MODAL -->
<div id="alert-modal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50">
<div class="bg-[var(--card-dark)] rounded-xl w-11/12 max-w-md overflow-hidden border border-zinc-700 shadow-2xl">
<div id="modal-header" class="text-lg font-bold p-4 rounded-t-lg text-white">Notification</div>
<div class="p-6">
<p id="alert-message" class="text-gray-200 mb-4"></p>
<button onclick="closeAlertModal()" class="w-full px-4 py-2 bg-zinc-700 hover:bg-zinc-600 text-white font-semibold rounded-lg">Close</button>
</div>
</div>
</div>

</body>
</html>
